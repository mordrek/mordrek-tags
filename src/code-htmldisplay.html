<script>
xtag.register('code-htmldisplay', 
	{
	extends: 'table',
	accessors:
		{
			code : { attribute: {}},
		},
	methods:
		{

		},
	lifecycle: 
		{
		created: function()
			{
				this.innerHTML = "<table style='width:100%;height:200px;'><tr></tr><tr><td style='max-width:50%; width:50%;'><textarea style='width:100%;height:100%;' ></textarea></td><td style='height:100%;'><div style='width:100%;height:100%;' ></div></td></tr></table>";
				 
				var l=this.querySelectorAll('div');
				var span = l[0];
				l=this.querySelectorAll('textarea');
				var area = l[0];
				area._w = this.offsetWidth;
				area._h = this.offsetHeight;
				area.onkeyup=function(){  span.innerHTML = area.value; };
				l=this.querySelectorAll('td');
				td1=l[0];
				td2=l[1];
				area.onmouseup=function(){ 
				var ev = document.createEvent('Event');
				ev.initEvent('resize', true, true);
				span.dispatchEvent(ev);}			
				
				this._area = area;
				this._span = span;
				this.code = this.code || this.innerHTML;
			},
		attributeChanged: function()
			{
				//var c = this.code.replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;").replace(/"/g, "&quot;");//.replace(/\n/g, "<br />");
				this._area.value = this.code;
				this._span.innerHTML = this.code;
			}
		}
	});


</script>