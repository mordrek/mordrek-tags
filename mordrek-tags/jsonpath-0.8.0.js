function jsonPath(obj,expr,arg){var P={resultType:arg&&arg.resultType||"VALUE",result:[],normalize:function(e){var t=[];return e.replace(/[\['](\??\(.*?\))[\]']/g,function(e,n){return"[#"+(t.push(n)-1)+"]"}).replace(/'?\.'?|\['?/g,";").replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,"").replace(/#([0-9]+)/g,function(e,n){return t[n]})},asPath:function(e){var t=e.split(";"),n="$";for(var r=1,i=t.length;r<i;r++)n+=/^[0-9*]+$/.test(t[r])?"["+t[r]+"]":"['"+t[r]+"']";return n},store:function(e,t){if(e)P.result[P.result.length]=P.resultType=="PATH"?P.asPath(e):t;return!!e},trace:function(e,t,n){if(e){var r=e.split(";"),i=r.shift();r=r.join(";");if(t&&t.hasOwnProperty(i))P.trace(r,t[i],n+";"+i);else if(i==="*")P.walk(i,r,t,n,function(e,t,n,r,i){P.trace(e+";"+n,r,i)});else if(i===".."){P.trace(r,t,n);P.walk(i,r,t,n,function(e,t,n,r,i){typeof r[e]==="object"&&P.trace("..;"+n,r[e],i+";"+e)})}else if(/,/.test(i)){for(var s=i.split(/'?,'?/),o=0,u=s.length;o<u;o++)P.trace(s[o]+";"+r,t,n)}else if(/^\(.*?\)$/.test(i))P.trace(P.eval(i,t,n.substr(n.lastIndexOf(";")+1))+";"+r,t,n);else if(/^\?\(.*?\)$/.test(i))P.walk(i,r,t,n,function(e,t,n,r,i){if(P.eval(t.replace(/^\?\((.*?)\)$/,"$1"),r[e],e))P.trace(e+";"+n,r,i)});else if(/^(-?[0-9]*):(-?[0-9]*):?([0-9]*)$/.test(i))P.slice(i,r,t,n)}else P.store(n,t)},walk:function(e,t,n,r,i){if(n instanceof Array){for(var s=0,o=n.length;s<o;s++)if(s in n)i(s,e,t,n,r)}else if(typeof n==="object"){for(var u in n)if(n.hasOwnProperty(u))i(u,e,t,n,r)}},slice:function(e,t,n,r){if(n instanceof Array){var i=n.length,s=0,o=i,u=1;e.replace(/^(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)$/g,function(e,t,n,r){s=parseInt(t||s);o=parseInt(n||o);u=parseInt(r||u)});s=s<0?Math.max(0,s+i):Math.min(i,s);o=o<0?Math.max(0,o+i):Math.min(i,o);for(var a=s;a<o;a+=u)P.trace(a+";"+t,n,r)}},eval:function(x,_v,_vname){try{return $&&_v&&eval(x.replace(/@/g,"_v"))}catch(e){throw new SyntaxError("jsonPath: "+e.message+": "+x.replace(/@/g,"_v").replace(/\^/g,"_a"))}}};var $=obj;if(expr&&obj&&(P.resultType=="VALUE"||P.resultType=="PATH")){P.trace(P.normalize(expr).replace(/^\$;/,""),obj,"$");return P.result.length?P.result:false}}